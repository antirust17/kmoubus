arr1 = ["토일공휴일",new Date(0,0,0,7,00,0),new Date(0,0,0,7,20,0),new Date(0,0,0,7,40,0),new Date(0,0,0,8,00,0),new Date(0,0,0,8,20,0),new Date(0,0,0,8,40,0),new Date(0,0,0,9,00,0),new Date(0,0,0,9,20,0),new Date(0,0,0,10,00,0),new Date(0,0,0,10,20,0),new Date(0,0,0,10,40,0),new Date(0,0,0,11,00,0),new Date(0,0,0,11,20,0),new Date(0,0,0,11,40,0),new Date(0,0,0,12,00,0),new Date(0,0,0,13,00,0),new Date(0,0,0,13,20,0),new Date(0,0,0,13,40,0),new Date(0,0,0,14,00,0),new Date(0,0,0,14,20,0),new Date(0,0,0,14,40,0),new Date(0,0,0,15,00,0),new Date(0,0,0,15,20,0),new Date(0,0,0,16,00,0),new Date(0,0,0,16,20,0),new Date(0,0,0,16,40,0),new Date(0,0,0,17,00,0),new Date(0,0,0,17,20,0),new Date(0,0,0,17,40,0),new Date(0,0,0,18,00,0),new Date(0,0,0,19,00,0),new Date(0,0,0,19,20,0),new Date(0,0,0,19,40,0),new Date(0,0,0,20,00,0),new Date(0,0,0,20,20,0),new Date(0,0,0,20,40,0),new Date(0,0,0,21,20,0),new Date(0,0,0,21,40,0),new Date(0,0,0,22,00,0),new Date(0,0,0,22,20,0),new Date(0,0,0,22,40,0),new Date(0,0,0,23,00,0),new Date(0,0,1,7,00,0),new Date(0,0,1,7,20,0)];
arr2 = ["방학중평일",new Date(0,0,0,7,00,0),new Date(0,0,0,7,20,0),new Date(0,0,0,7,40,0),new Date(0,0,0,8,00,0),new Date(0,0,0,8,10,0),new Date(0,0,0,8,20,0),new Date(0,0,0,8,30,0),new Date(0,0,0,8,40,0),new Date(0,0,0,8,50,0),new Date(0,0,0,9,00,0),new Date(0,0,0,9,10,0),new Date(0,0,0,9,20,0),new Date(0,0,0,9,30,0),new Date(0,0,0,9,40,0),new Date(0,0,0,9,50,0),new Date(0,0,0,10,10,0),new Date(0,0,0,10,30,0),new Date(0,0,0,10,50,0),new Date(0,0,0,11,10,0),new Date(0,0,0,11,20,0),new Date(0,0,0,11,30,0),new Date(0,0,0,11,40,0),new Date(0,0,0,12,00,0),new Date(0,0,0,12,20,0),new Date(0,0,0,12,30,0),new Date(0,0,0,12,40,0),new Date(0,0,0,12,50,0),new Date(0,0,0,13,10,0),new Date(0,0,0,13,30,0),new Date(0,0,0,13,40,0),new Date(0,0,0,13,50,0),new Date(0,0,0,14,00,0),new Date(0,0,0,14,20,0),new Date(0,0,0,14,40,0),new Date(0,0,0,15,00,0),new Date(0,0,0,15,20,0),new Date(0,0,0,15,30,0),new Date(0,0,0,15,40,0),new Date(0,0,0,15,50,0),new Date(0,0,0,16,10,0),new Date(0,0,0,16,30,0),new Date(0,0,0,16,50,0),new Date(0,0,0,17,00,0),new Date(0,0,0,17,10,0),new Date(0,0,0,17,20,0),new Date(0,0,0,17,30,0),new Date(0,0,0,17,40,0),new Date(0,0,0,17,50,0),new Date(0,0,0,18,00,0),new Date(0,0,0,18,20,0),new Date(0,0,0,18,40,0),new Date(0,0,0,19,00,0),new Date(0,0,0,19,20,0),new Date(0,0,0,19,40,0),new Date(0,0,0,20,00,0),new Date(0,0,0,20,20,0),new Date(0,0,0,20,40,0),new Date(0,0,0,21,20,0),new Date(0,0,0,21,40,0),new Date(0,0,0,22,00,0),new Date(0,0,0,22,20,0),new Date(0,0,0,22,40,0),new Date(0,0,0,23,00,0),new Date(0,0,1,7,00,0),new Date(0,0,1,7,20,0)];
arr3 = ["학기중평일",new Date(0,0,0,7,00,0),new Date(0,0,0,7,20,0),new Date(0,0,0,7,30,0),new Date(0,0,0,7,40,0),new Date(0,0,0,7,50,0),new Date(0,0,0,8,00,0),new Date(0,0,0,8,05,0),new Date(0,0,0,8,10,0),new Date(0,0,0,8,15,0),new Date(0,0,0,8,20,0),new Date(0,0,0,8,25,0),new Date(0,0,0,8,30,0),new Date(0,0,0,8,35,0),new Date(0,0,0,8,40,0),new Date(0,0,0,8,45,0),new Date(0,0,0,8,50,0),new Date(0,0,0,8,55,0),new Date(0,0,0,9,00,0),new Date(0,0,0,9,05,0),new Date(0,0,0,9,10,0),new Date(0,0,0,9,15,0),new Date(0,0,0,9,20,0),new Date(0,0,0,9,25,0),new Date(0,0,0,9,30,0),new Date(0,0,0,9,35,0),new Date(0,0,0,9,40,0),new Date(0,0,0,9,45,0),new Date(0,0,0,9,50,0),new Date(0,0,0,9,55,0),new Date(0,0,0,10,00,0),new Date(0,0,0,10,10,0),new Date(0,0,0,10,20,0),new Date(0,0,0,10,30,0),new Date(0,0,0,10,40,0),new Date(0,0,0,10,50,0),new Date(0,0,0,11,00,0),new Date(0,0,0,11,10,0),new Date(0,0,0,11,20,0),new Date(0,0,0,11,30,0),new Date(0,0,0,11,40,0),new Date(0,0,0,11,50,0),new Date(0,0,0,12,00,0),new Date(0,0,0,12,10,0),new Date(0,0,0,12,20,0),new Date(0,0,0,12,30,0),new Date(0,0,0,12,40,0),new Date(0,0,0,12,50,0),new Date(0,0,0,13,00,0),new Date(0,0,0,13,10,0),new Date(0,0,0,13,20,0),new Date(0,0,0,13,30,0),new Date(0,0,0,13,40,0),new Date(0,0,0,13,50,0),new Date(0,0,0,14,00,0),new Date(0,0,0,14,10,0),new Date(0,0,0,14,20,0),new Date(0,0,0,14,30,0),new Date(0,0,0,14,40,0),new Date(0,0,0,14,50,0),new Date(0,0,0,15,00,0),new Date(0,0,0,15,10,0),new Date(0,0,0,15,20,0),new Date(0,0,0,15,30,0),new Date(0,0,0,15,40,0),new Date(0,0,0,15,50,0),new Date(0,0,0,16,00,0),new Date(0,0,0,16,10,0),new Date(0,0,0,16,20,0),new Date(0,0,0,16,30,0),new Date(0,0,0,16,40,0),new Date(0,0,0,16,50,0),new Date(0,0,0,17,00,0),new Date(0,0,0,17,05,0),new Date(0,0,0,17,10,0),new Date(0,0,0,17,15,0),new Date(0,0,0,17,20,0),new Date(0,0,0,17,25,0),new Date(0,0,0,17,30,0),new Date(0,0,0,17,35,0),new Date(0,0,0,17,40,0),new Date(0,0,0,17,45,0),new Date(0,0,0,17,50,0),new Date(0,0,0,17,55,0),new Date(0,0,0,18,00,0),new Date(0,0,0,18,10,0),new Date(0,0,0,18,20,0),new Date(0,0,0,18,30,0),new Date(0,0,0,18,40,0),new Date(0,0,0,19,00,0),new Date(0,0,0,19,20,0),new Date(0,0,0,19,40,0),new Date(0,0,0,20,00,0),new Date(0,0,0,20,20,0),new Date(0,0,0,20,40,0),new Date(0,0,0,21,20,0),new Date(0,0,0,21,40,0),new Date(0,0,0,22,00,0),new Date(0,0,0,22,20,0),new Date(0,0,0,22,40,0),new Date(0,0,0,23,00,0),new Date(0,0,1,7,00,0),new Date(0,0,1,7,20,0)];
arr4 = ["일공휴일",new Date(0,0,0,4,55,0),new Date(0,0,0,5,11,0),new Date(0,0,0,5,26,0),new Date(0,0,0,5,42,0),new Date(0,0,0,5,57,0),new Date(0,0,0,6,13,0),new Date(0,0,0,6,28,0),new Date(0,0,0,6,44,0),new Date(0,0,0,6,59,0),new Date(0,0,0,7,15,0),new Date(0,0,0,7,30,0),new Date(0,0,0,7,48,0),new Date(0,0,0,8,06,0),new Date(0,0,0,8,24,0),new Date(0,0,0,8,42,0),new Date(0,0,0,9,00,0),new Date(0,0,0,9,18,0),new Date(0,0,0,9,36,0),new Date(0,0,0,9,54,0),new Date(0,0,0,10,12,0),new Date(0,0,0,10,30,0),new Date(0,0,0,10,48,0),new Date(0,0,0,11,06,0),new Date(0,0,0,11,24,0),new Date(0,0,0,11,42,0),new Date(0,0,0,12,00,0),new Date(0,0,0,12,18,0),new Date(0,0,0,12,36,0),new Date(0,0,0,12,54,0),new Date(0,0,0,13,12,0),new Date(0,0,0,13,30,0),new Date(0,0,0,13,48,0),new Date(0,0,0,14,06,0),new Date(0,0,0,14,24,0),new Date(0,0,0,14,42,0),new Date(0,0,0,15,00,0),new Date(0,0,0,15,18,0),new Date(0,0,0,15,36,0),new Date(0,0,0,15,54,0),new Date(0,0,0,16,12,0),new Date(0,0,0,16,30,0),new Date(0,0,0,16,48,0),new Date(0,0,0,17,06,0),new Date(0,0,0,17,24,0),new Date(0,0,0,17,42,0),new Date(0,0,0,18,00,0),new Date(0,0,0,18,18,0),new Date(0,0,0,18,36,0),new Date(0,0,0,18,54,0),new Date(0,0,0,19,12,0),new Date(0,0,0,19,30,0),new Date(0,0,0,19,48,0),new Date(0,0,0,20,05,0),new Date(0,0,0,20,40,0),new Date(0,0,0,20,58,0),new Date(0,0,0,21,15,0),new Date(0,0,0,21,33,0),new Date(0,0,0,21,50,0),new Date(0,0,1,4,55,0),new Date(0,0,1,5,11,0)];
arr5 = ["토요일",new Date(0,0,0,4,55,0),new Date(0,0,0,5,10,0),new Date(0,0,0,5,25,0),new Date(0,0,0,5,40,0),new Date(0,0,0,5,55,0),new Date(0,0,0,6,10,0),new Date(0,0,0,6,24,0),new Date(0,0,0,6,38,0),new Date(0,0,0,6,52,0),new Date(0,0,0,7,06,0),new Date(0,0,0,7,20,0),new Date(0,0,0,7,35,0),new Date(0,0,0,7,52,0),new Date(0,0,0,8,09,0),new Date(0,0,0,8,26,0),new Date(0,0,0,8,43,0),new Date(0,0,0,9,00,0),new Date(0,0,0,9,17,0),new Date(0,0,0,9,34,0),new Date(0,0,0,9,51,0),new Date(0,0,0,10,07,0),new Date(0,0,0,10,23,0),new Date(0,0,0,10,40,0),new Date(0,0,0,10,57,0),new Date(0,0,0,11,14,0),new Date(0,0,0,11,31,0),new Date(0,0,0,11,48,0),new Date(0,0,0,12,05,0),new Date(0,0,0,12,22,0),new Date(0,0,0,12,39,0),new Date(0,0,0,12,56,0),new Date(0,0,0,13,12,0),new Date(0,0,0,13,28,0),new Date(0,0,0,13,45,0),new Date(0,0,0,14,02,0),new Date(0,0,0,14,19,0),new Date(0,0,0,14,36,0),new Date(0,0,0,14,53,0),new Date(0,0,0,15,10,0),new Date(0,0,0,15,27,0),new Date(0,0,0,15,44,0),new Date(0,0,0,16,01,0),new Date(0,0,0,16,17,0),new Date(0,0,0,16,34,0),new Date(0,0,0,16,50,0),new Date(0,0,0,17,07,0),new Date(0,0,0,17,24,0),new Date(0,0,0,17,41,0),new Date(0,0,0,17,58,0),new Date(0,0,0,18,15,0),new Date(0,0,0,18,31,0),new Date(0,0,0,18,47,0),new Date(0,0,0,19,03,0),new Date(0,0,0,19,18,0),new Date(0,0,0,19,33,0),new Date(0,0,0,19,48,0),new Date(0,0,0,20,03,0),new Date(0,0,0,20,18,0),new Date(0,0,0,20,33,0),new Date(0,0,0,20,49,0),new Date(0,0,0,21,04,0),new Date(0,0,0,21,19,0),new Date(0,0,0,21,34,0),new Date(0,0,0,21,50,0),new Date(0,0,1,4,55,0),new Date(0,0,1,5,10,0)];
arr6 = ["평일",new Date(0,0,0,4,55,0),new Date(0,0,0,5,07,0),new Date(0,0,0,5,20,0),new Date(0,0,0,5,32,0),new Date(0,0,0,5,45,0),new Date(0,0,0,5,57,0),new Date(0,0,0,6,10,0),new Date(0,0,0,6,22,0),new Date(0,0,0,6,35,0),new Date(0,0,0,6,47,0),new Date(0,0,0,7,00,0),new Date(0,0,0,7,12,0),new Date(0,0,0,7,30,0),new Date(0,0,0,7,45,0),new Date(0,0,0,8,00,0),new Date(0,0,0,8,16,0),new Date(0,0,0,8,31,0),new Date(0,0,0,8,46,0),new Date(0,0,0,9,02,0),new Date(0,0,0,9,17,0),new Date(0,0,0,9,33,0),new Date(0,0,0,9,49,0),new Date(0,0,0,10,04,0),new Date(0,0,0,10,17,0),new Date(0,0,0,10,35,0),new Date(0,0,0,10,50,0),new Date(0,0,0,11,05,0),new Date(0,0,0,11,20,0),new Date(0,0,0,11,35,0),new Date(0,0,0,11,50,0),new Date(0,0,0,12,05,0),new Date(0,0,0,12,20,0),new Date(0,0,0,12,35,0),new Date(0,0,0,12,50,0),new Date(0,0,0,13,05,0),new Date(0,0,0,13,20,0),new Date(0,0,0,13,35,0),new Date(0,0,0,13,50,0),new Date(0,0,0,14,05,0),new Date(0,0,0,14,21,0),new Date(0,0,0,14,36,0),new Date(0,0,0,14,51,0),new Date(0,0,0,15,07,0),new Date(0,0,0,15,22,0),new Date(0,0,0,15,37,0),new Date(0,0,0,15,52,0),new Date(0,0,0,16,07,0),new Date(0,0,0,16,22,0),new Date(0,0,0,16,40,0),new Date(0,0,0,16,54,0),new Date(0,0,0,17,09,0),new Date(0,0,0,17,23,0),new Date(0,0,0,17,38,0),new Date(0,0,0,17,52,0),new Date(0,0,0,18,07,0),new Date(0,0,0,18,21,0),new Date(0,0,0,18,36,0),new Date(0,0,0,18,51,0),new Date(0,0,0,19,05,0),new Date(0,0,0,19,20,0),new Date(0,0,0,19,35,0),new Date(0,0,0,19,50,0),new Date(0,0,0,20,06,0),new Date(0,0,0,20,21,0),new Date(0,0,0,20,36,0),new Date(0,0,0,20,51,0),new Date(0,0,0,21,06,0),new Date(0,0,0,21,21,0),new Date(0,0,0,21,36,0),new Date(0,0,0,21,50,0),new Date(0,0,1,4,55,0),new Date(0,0,1,5,07,0)];

function kmoubusMain(){
	now = new Date();
	nowYear = now.getFullYear();
	nowMonth = now.getMonth() + 1;
	nowDay = now.getDate();
	nowHour = now.getHours();
	nowMin = now.getMinutes();
	nowSec = now.getSeconds();
	nowWeek = now.getDay();
	nowWeekText = ["일요일","월요일","화요일","수요일","목요일","금요일","토요일"];

	//date varable의 할당 문제. http://stackoverflow.com/questions/6609574/javascript-date-variable-assignment 참고
	now.setFullYear(arr1[1].getFullYear());
	now.setMonth(arr1[1].getMonth());
	now.setDate(arr1[1].getDate());
	
	nowVacation = false; //방학일경우 true, 학기중이면 false

	//순환버스용 요일, 방학 여부 판단
	if (nowWeek == 0 || nowWeek == 6) 
		arrShuttle = arr1;
	else if (nowVacation == true) 
		arrShuttle = arr2;
	else 
		arrShuttle = arr3;

	//순환버스 다음 출발시간 찾기
	shuttleLoop = 1;
	while (now.getTime() >= arrShuttle[shuttleLoop].getTime()) 
		shuttleLoop++;

	//시내버스용 요일 판단
	if (nowWeek == 0 )
		arr190 = arr4;
	else if (nowWeek == 6)
		arr190 = arr5;
	else 
		arr190 = arr6;

	//190번 시내버스 다음 출발시간 찾기 
	cityLoop = 1;
	while (now.getTime() >= arr190[cityLoop].getTime()) 
		cityLoop++;

	//현재시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nowTime").length;i++)
		document.getElementsByClassName("kmoubus-nowTime")[i].innerHTML = nowYear + "." + addZero(nowMonth) + "." + addZero(nowDay) + ". " + nowWeekText[nowWeek]
														+ " " + addZero(nowHour)+":"+addZero(nowMin)+":"+addZero(nowSec);
	//다음 순환버스 출발시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nextShuttle").length;i++)
		document.getElementsByClassName("kmoubus-nextShuttle")[i].innerHTML = addZero(arrShuttle[shuttleLoop].getHours()) + ":" + addZero(arrShuttle[shuttleLoop].getMinutes()) ;
	
	//다음 순환버스 출발시간까지 남은시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nextShuttleRemaining").length;i++)
		document.getElementsByClassName("kmoubus-nextShuttleRemaining")[i].innerHTML = Math.floor( (arrShuttle[shuttleLoop].getTime() - now.getTime()) / 60000 )  ;

	//그 다음 순환버스 출발시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nNextShuttle").length;i++)
		document.getElementsByClassName("kmoubus-nNextShuttle")[i].innerHTML = addZero(arrShuttle[shuttleLoop+1].getHours()) + ":" + addZero(arrShuttle[shuttleLoop+1].getMinutes()) ;
	
	//그 다음 순환버스 출발까지 남은시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nNextShuttleRemaining").length;i++)
		document.getElementsByClassName("kmoubus-nNextShuttleRemaining")[i].innerHTML = Math.floor( (arrShuttle[shuttleLoop+1].getTime() - now.getTime()) / 60000 )  ;

	//다음 190번 시내버스 출발시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-next190").length;i++)
		document.getElementsByClassName("kmoubus-next190")[i].innerHTML = addZero(arr190[cityLoop].getHours()) + ":" + addZero(arr190[cityLoop].getMinutes()) ;
	
	//다음 190번 시내버스 출발까지 남은시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-next190Remaining").length;i++)
		document.getElementsByClassName("kmoubus-next190Remaining")[i].innerHTML = Math.floor( (arr190[cityLoop].getTime() - now.getTime()) / 60000 )  ;

	//그 다음 190번 시내버스 출발시간 출력	
	for (i=0;i<document.getElementsByClassName("kmoubus-nNext190").length;i++)
		document.getElementsByClassName("kmoubus-nNext190")[i].innerHTML = addZero(arr190[cityLoop+1].getHours()) + ":" + addZero(arr190[cityLoop+1].getMinutes()) ;
	//그 다음 190번 시내버스 출발까지 남은시간 출력
	for (i=0;i<document.getElementsByClassName("kmoubus-nNext190Remaining").length;i++)
		document.getElementsByClassName("kmoubus-nNext190Remaining")[i].innerHTML = Math.floor( (arr190[cityLoop+1].getTime() - now.getTime()) / 60000 )  ;
	
	//0.5초마다 갱신
	setTimeout(kmoubusMain, 500);
}

//숫자 두 자리 표기를 위함
function addZero(i){
	if (i < 10) {i = "0" + i};
	return i;
}
